# HR ê´€ë¦¬ ì‹œìŠ¤í…œ - ìŠ¤ì¼€ì¤„ í…œí”Œë¦¿ ê´€ë¦¬ API ë¬¸ì„œ

## ğŸ“‹ ê°œìš”

ì´ ë¬¸ì„œëŠ” HR ê´€ë¦¬ ì‹œìŠ¤í…œì˜ ìŠ¤ì¼€ì¤„ í…œí”Œë¦¿ ê´€ë¦¬ ê¸°ëŠ¥ì— ëŒ€í•œ ì¢…í•©ì ì¸ API ë° êµ¬í˜„ ê°€ì´ë“œì…ë‹ˆë‹¤.

### ì£¼ìš” ê¸°ëŠ¥
- âœ… **ìŠ¤ì¼€ì¤„ í…œí”Œë¦¿ ê´€ë¦¬**: JSONB ê¸°ë°˜ ìœ ì—°í•œ ì£¼ê°„ ìŠ¤ì¼€ì¤„ í…œí”Œë¦¿
- âœ… **ì§ì› ê´€ë¦¬**: ìŠ¤í† ì–´ë³„ ì§ì› ì¶”ê°€/ìˆ˜ì •/ìƒíƒœ ê´€ë¦¬
- âœ… **ë¸Œë ˆì´í¬ ì‹œê°„ ì„¤ì •**: ìš”ì¼ë³„ ì„¸ë¶„í™”ëœ ë¸Œë ˆì´í¬ ì‹œê°„ ê´€ë¦¬
- âœ… **ì‹œê°„ ìŠ¬ë¡¯ ê´€ë¦¬**: 30ë¶„ ë‹¨ìœ„ ì‹œê°„ ìŠ¬ë¡¯ë³„ ì§ì› ë°°ì •
- âœ… **ê¶Œí•œ ê´€ë¦¬**: RLS ì •ì±… ê¸°ë°˜ ìŠ¤í† ì–´ ì†Œìœ ì ê¶Œí•œ ì œì–´

## ğŸ“ ë¬¸ì„œ êµ¬ì¡°

| ë¬¸ì„œ | ì„¤ëª… |
|------|------|
| **[schedule-template-api.md](./schedule-template-api.md)** | ëª¨ë“  API í•¨ìˆ˜ì™€ React Hook ì •ë¦¬ |
| **[schedule-utils.md](./schedule-utils.md)** | ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ë° í—¬í¼ í•¨ìˆ˜ë“¤ |
| **[template-service.md](./template-service.md)** | ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ |
| **[ui-components.md](./ui-components.md)** | UI ì»´í¬ë„ŒíŠ¸ êµ¬ì¡° ë° íŒ¨í„´ |

## ğŸ—ï¸ ì „ì²´ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    UI Layer                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Templates Page  â”‚  Employees Page  â”‚  Breaks Page     â”‚
â”‚  - í…œí”Œë¦¿ ê´€ë¦¬    â”‚  - ì§ì› ê´€ë¦¬      â”‚  - ë¸Œë ˆì´í¬ ì„¤ì •  â”‚
â”‚  - ì‹œê°„ ìŠ¬ë¡¯ ë°°ì • â”‚  - ìƒíƒœ ê´€ë¦¬      â”‚  - ìš”ì¼ë³„ ê´€ë¦¬    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Business Logic Layer                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  useScheduleTemplates Hook  â”‚  TemplateService Class   â”‚
â”‚  - ìƒíƒœ ê´€ë¦¬                â”‚  - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§          â”‚
â”‚  - API í˜¸ì¶œ ì¡°ìœ¨            â”‚  - ë°ì´í„° ë³€í™˜            â”‚
â”‚  - ì—ëŸ¬ ì²˜ë¦¬                â”‚  - ê²€ì¦ ë¡œì§              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   API Layer                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  schedule-api.ts            â”‚  schedule-utils.ts        â”‚
â”‚  - CRUD ì‘ì—…                â”‚  - ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜          â”‚
â”‚  - Supabase ì—°ë™            â”‚  - ì‹œê°„ ë³€í™˜              â”‚
â”‚  - ì—ëŸ¬ ì²˜ë¦¬                â”‚  - ë°ì´í„° ì¡°ì‘            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Database Layer                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Supabase PostgreSQL                                   â”‚
â”‚  - weekly_schedule_templates (JSONB)                   â”‚
â”‚  - employees (RLS ì •ì±…)                                â”‚
â”‚  - store_settings                                      â”‚
â”‚  - RLS ì •ì±… ë° íŠ¸ë¦¬ê±°                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ ë°ì´í„° í”Œë¡œìš°

### 1. í…œí”Œë¦¿ ìƒì„±/ìˆ˜ì • í”Œë¡œìš°
```
ì‚¬ìš©ì ì…ë ¥ â†’ UI ì»´í¬ë„ŒíŠ¸ â†’ TemplateService â†’ schedule-utils â†’ API í•¨ìˆ˜ â†’ Supabase
     â†“
ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸ â† useScheduleTemplates Hook â† API ì‘ë‹µ â† Supabase
```

### 2. ì§ì› ê´€ë¦¬ í”Œë¡œìš°
```
ì§ì› í¼ â†’ ìœ íš¨ì„± ê²€ì¦ â†’ addEmployee/editEmployee â†’ createEmployee/updateEmployee â†’ Supabase
    â†“
ì§ì› ëª©ë¡ ì—…ë°ì´íŠ¸ â† ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸ â† API ì‘ë‹µ â† RLS ì •ì±… ì ìš©
```

### 3. ë¸Œë ˆì´í¬ ì‹œê°„ ì„¤ì • í”Œë¡œìš°
```
ë¸Œë ˆì´í¬ í¼ â†’ ì‹œê°„ ê²€ì¦ â†’ updateTemplate â†’ updateScheduleTemplate â†’ JSONB ì—…ë°ì´íŠ¸
     â†“
ì‹¤ì‹œê°„ UI ì—…ë°ì´íŠ¸ â† ë¡œì»¬ ìƒíƒœ ë™ê¸°í™” â† API ì‘ë‹µ
```

## ğŸ“Š í•µì‹¬ ë°ì´í„° êµ¬ì¡°

### JSONB ìŠ¤ì¼€ì¤„ êµ¬ì¡°
```typescript
{
  "monday": {
    "is_open": true,
    "open_time": "09:00",
    "close_time": "18:00",
    "break_periods": [
      { "name": "ì ì‹¬ì‹œê°„", "start": "12:00", "end": "13:00" }
    ],
    "time_slots": {
      "09:00": [123, 456],  // ì§ì› ID ë°°ì—´
      "09:30": [123],
      "10:00": [456, 789]
    }
  },
  // ... ë‹¤ë¥¸ ìš”ì¼ë“¤
}
```

### ì§ì› ë°ì´í„° êµ¬ì¡°
```typescript
{
  "id": 123,
  "store_id": 1,
  "owner_id": "uuid-string",
  "name": "í™ê¸¸ë™",
  "position": "ë§¤ë‹ˆì €",
  "hourly_wage": 12000,
  "phone": "010-1234-5678",
  "start_date": "2025-01-01",
  "is_active": true
}
```

## ğŸ” ë³´ì•ˆ ë° ê¶Œí•œ

### Row Level Security (RLS) ì •ì±…
```sql
-- ì§ì› í…Œì´ë¸” ì ‘ê·¼ ì œì–´
CREATE POLICY employees_select_policy ON employees
  FOR SELECT USING (auth.uid() = owner_id);

-- ìŠ¤í† ì–´ ì„¤ì • ì ‘ê·¼ ì œì–´  
CREATE POLICY store_settings_select_policy ON store_settings
  FOR SELECT USING (auth.uid() = owner_id);

-- í…œí”Œë¦¿ ì ‘ê·¼ ì œì–´ (ìŠ¤í† ì–´ ì†Œìœ ì ê¸°ë°˜)
CREATE POLICY templates_select_policy ON weekly_schedule_templates
  FOR SELECT USING (
    EXISTS (
      SELECT 1 FROM store_settings 
      WHERE id = store_id AND owner_id = auth.uid()
    )
  );
```

### ìë™ íŠ¸ë¦¬ê±°
```sql
-- ì§ì› ìƒì„± ì‹œ owner_id ìë™ ì„¤ì •
CREATE TRIGGER set_employee_owner_trigger
  BEFORE INSERT OR UPDATE ON employees
  FOR EACH ROW EXECUTE FUNCTION set_employee_owner();
```

## ğŸš€ ì£¼ìš” ê¸°ëŠ¥ë³„ ì‚¬ìš©ë²•

### 1. ìƒˆ í…œí”Œë¦¿ ìƒì„±
```typescript
// 1. ê¸°ë³¸ ìŠ¤ì¼€ì¤„ ìƒì„±
const defaultSchedule = createDefaultWeekSchedule(storeSettings);

// 2. í…œí”Œë¦¿ ìƒì„±
const templateId = await createTemplate(
  storeId, 
  "ì£¼ê°„ ê¸°ë³¸ í…œí”Œë¦¿", 
  defaultSchedule
);

// 3. ë¡œì»¬ ìƒíƒœ ìë™ ì—…ë°ì´íŠ¸
```

### 2. ì§ì› ì¶”ê°€ ë° ë°°ì •
```typescript
// 1. ì§ì› ì¶”ê°€
const newEmployee = await addEmployee({
  store_id: currentStore.id,
  name: "ê¹€ì§ì›",
  hourly_wage: 10030,
  position: "ì•„ë¥´ë°”ì´íŠ¸",
  is_active: true
});

// 2. ì‹œê°„ ìŠ¬ë¡¯ì— ë°°ì •
const updatedSchedule = templateService.toggleEmployeeInSlot(
  scheduleData,
  'monday',
  '14:00',
  newEmployee.id
);
```

### 3. ë¸Œë ˆì´í¬ ì‹œê°„ ì„¤ì •
```typescript
// 1. ë¸Œë ˆì´í¬ ì‹œê°„ ì¶”ê°€
const breakPeriod = {
  name: "ì ì‹¬ì‹œê°„",
  start: "12:00", 
  end: "13:00"
};

// 2. ìŠ¤ì¼€ì¤„ì— ì ìš©
const updatedSchedule = templateService.addBreakPeriod(
  scheduleData,
  'tuesday',
  breakPeriod
);

// 3. í…œí”Œë¦¿ ì—…ë°ì´íŠ¸
await updateTemplate(templateId, templateName, updatedSchedule);
```

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™” ì „ëµ

### 1. í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ
- **React.memo()**: ì»´í¬ë„ŒíŠ¸ ë¦¬ë Œë”ë§ ìµœì í™”
- **useCallback()**: í•¨ìˆ˜ ë©”ëª¨ì´ì œì´ì…˜
- **useMemo()**: ë³µì¡í•œ ê³„ì‚° ê²°ê³¼ ìºì‹±
- **ì§€ì—° ë¡œë”©**: í•„ìš”í•  ë•Œë§Œ ë°ì´í„° ë¡œë“œ

### 2. ì„œë²„ ì‚¬ì´ë“œ
- **JSONB ì¸ë±ìŠ¤**: ìŠ¤ì¼€ì¤„ ë°ì´í„° ê²€ìƒ‰ ìµœì í™”
- **RLS ì •ì±…**: ë°ì´í„°ë² ì´ìŠ¤ ë ˆë²¨ ê¶Œí•œ ì œì–´
- **PostgreSQL í•¨ìˆ˜**: ì„œë²„ ì‚¬ì´ë“œ ë¡œì§ ì²˜ë¦¬

### 3. ë„¤íŠ¸ì›Œí¬
- **ë°°ì¹˜ ì²˜ë¦¬**: ì—¬ëŸ¬ ë³€ê²½ì‚¬í•­ í•œ ë²ˆì— ì „ì†¡
- **ë‚™ê´€ì  ì—…ë°ì´íŠ¸**: UI ì¦‰ì‹œ ë°˜ì˜ í›„ ì„œë²„ ë™ê¸°í™”
- **ì—ëŸ¬ ë³µêµ¬**: ì‹¤íŒ¨ ì‹œ ìë™ ì¬ì‹œë„

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì „ëµ

### 1. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
```typescript
// API í•¨ìˆ˜ í…ŒìŠ¤íŠ¸
describe('createEmployee', () => {
  it('should create employee with correct data', async () => {
    const employeeData = {
      store_id: 1,
      name: 'í…ŒìŠ¤íŠ¸ì§ì›',
      hourly_wage: 10030,
      is_active: true
    };
    
    const result = await createEmployee(employeeData);
    expect(result.name).toBe('í…ŒìŠ¤íŠ¸ì§ì›');
  });
});

// ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ í…ŒìŠ¤íŠ¸
describe('generateTimeSlots', () => {
  it('should generate correct time slots', () => {
    const slots = generateTimeSlots('09:00', '12:00', 30);
    expect(slots).toEqual(['09:00', '09:30', '10:00', '10:30', '11:00', '11:30']);
  });
});
```

### 2. í†µí•© í…ŒìŠ¤íŠ¸
```typescript
// Hook í…ŒìŠ¤íŠ¸
describe('useScheduleTemplates', () => {
  it('should load templates when store changes', async () => {
    const { result } = renderHook(() => useScheduleTemplates());
    
    act(() => {
      result.current.setCurrentStore(mockStore);
    });
    
    await waitFor(() => {
      expect(result.current.templates).toHaveLength(2);
    });
  });
});
```

### 3. E2E í…ŒìŠ¤íŠ¸
```typescript
// Playwright ë˜ëŠ” Cypress
test('should create and edit template', async ({ page }) => {
  await page.goto('/templates');
  await page.click('[data-testid="create-template"]');
  await page.fill('[data-testid="template-name"]', 'ìƒˆ í…œí”Œë¦¿');
  await page.click('[data-testid="save-template"]');
  
  await expect(page.locator('[data-testid="template-list"]')).toContainText('ìƒˆ í…œí”Œë¦¿');
});
```

## ğŸ”§ ê°œë°œ í™˜ê²½ ì„¤ì •

### í•„ìˆ˜ ì˜ì¡´ì„±
```json
{
  "dependencies": {
    "@supabase/supabase-js": "^2.x",
    "react": "^18.x",
    "typescript": "^5.x",
    "lucide-react": "^0.x"
  },
  "devDependencies": {
    "@testing-library/react": "^14.x",
    "@testing-library/jest-dom": "^6.x",
    "jest": "^29.x"
  }
}
```

### í™˜ê²½ ë³€ìˆ˜
```env
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
```

## ğŸš¨ ì•Œë ¤ì§„ ì œí•œì‚¬í•­ ë° ê³ ë ¤ì‚¬í•­

### 1. í˜„ì¬ ì œí•œì‚¬í•­
- **ì‹œê°„ëŒ€ ì§€ì›**: í˜„ì¬ ë¡œì»¬ ì‹œê°„ëŒ€ë§Œ ì§€ì›
- **ëŒ€ëŸ‰ ë°ì´í„°**: 1000ëª… ì´ìƒ ì§ì› ì‹œ ì„±ëŠ¥ ì €í•˜ ê°€ëŠ¥
- **ì‹¤ì‹œê°„ ë™ê¸°í™”**: ì—¬ëŸ¬ ì‚¬ìš©ì ë™ì‹œ í¸ì§‘ ì‹œ ì¶©ëŒ ê°€ëŠ¥

### 2. í–¥í›„ ê°œì„  ê³„íš
- **êµ­ì œí™”**: ë‹¤ì–‘í•œ ì–¸ì–´ ë° ì‹œê°„ëŒ€ ì§€ì›
- **ì‹¤ì‹œê°„ í˜‘ì—…**: WebSocket ê¸°ë°˜ ì‹¤ì‹œê°„ ë™ê¸°í™”
- **ëª¨ë°”ì¼ ìµœì í™”**: PWA ë° ë°˜ì‘í˜• ê°œì„ 
- **ê³ ê¸‰ ë¶„ì„**: ìŠ¤ì¼€ì¤„ íš¨ìœ¨ì„± ë¶„ì„ ëŒ€ì‹œë³´ë“œ

## ğŸ“ ì§€ì› ë° ë¬¸ì˜

### ê°œë°œíŒ€ ì—°ë½ì²˜
- **ê¸°ìˆ  ë¬¸ì˜**: ê°œë°œíŒ€ ì´ë©”ì¼
- **ë²„ê·¸ ë¦¬í¬íŠ¸**: GitHub Issues
- **ê¸°ëŠ¥ ìš”ì²­**: ì œí’ˆ íŒ€ ì—°ë½ì²˜

### ìœ ìš©í•œ ë§í¬
- [Supabase ë¬¸ì„œ](https://supabase.com/docs)
- [React Hook ê°€ì´ë“œ](https://react.dev/reference/react)
- [TypeScript í•¸ë“œë¶](https://www.typescriptlang.org/docs/)

---

## ğŸ“ ë³€ê²½ ì´ë ¥

| ë²„ì „ | ë‚ ì§œ | ë³€ê²½ ë‚´ìš© |
|------|------|-----------|
| 1.0.0 | 2025-08-14 | ì´ˆê¸° ìŠ¤ì¼€ì¤„ í…œí”Œë¦¿ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬í˜„ |
| | | - JSONB ê¸°ë°˜ ìœ ì—°í•œ ìŠ¤ì¼€ì¤„ êµ¬ì¡° |
| | | - ì§ì› ê´€ë¦¬ ë° ë¸Œë ˆì´í¬ ì‹œê°„ ì„¤ì • |
| | | - RLS ì •ì±… ê¸°ë°˜ ê¶Œí•œ ì œì–´ |
| | | - React Hook ë° ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ ë¶„ë¦¬ |

---

**ğŸ“Œ ì´ ë¬¸ì„œëŠ” ì§€ì†ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤. ìµœì‹  ë²„ì „ì„ í™•ì¸í•´ì£¼ì„¸ìš”.**
